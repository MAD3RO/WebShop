@model WebShop.Models.ViewModels.Shop.ProductVM

@{
    ViewBag.Title = Model.Name;
}

<!-- SECTION -->
<div class="section">
    <!-- container -->
    <div class="container">
        <!-- row -->
        <div class="row">
            <!-- Product main img -->
            <div class="col-md-5 col-md-push-2">
                <div id="product-main-img">
                    @if (Model.GalleryImages.Any())
                    {
                        foreach (var image in Model.GalleryImages)
                        {
                            <div class="product-preview">
                                <img src="/Images/Uploads/Products/@Model.Id/Gallery/@image" alt="">
                            </div>
                        }
                    }
                    else
                    {
                        <h5 class="text-center text-danger">There are no images in product gallery.</h5>
                    }
                </div>
            </div>
            <!-- /Product main img -->
            <!-- Product thumb imgs -->
            <div class="col-md-2  col-md-pull-5">
                <div id="product-imgs">
                    @if (Model.GalleryImages.Any())
                    {
                        foreach (var image in Model.GalleryImages)
                        {
                            <div class="product-preview">
                                <a class="fancybox" rel="gallery1" href="/Images/Uploads/Products/@Model.Id/Gallery/@image">
                                    <img src="/Images/Uploads/Products/@Model.Id/Gallery/Thumbs/@image" alt="">
                                </a>
                            </div>
                        }
                    }
                </div>
            </div>
            <!-- /Product thumb imgs -->
            <!-- Product details -->
            <div class="col-md-5">
                <div class="product-details">
                    <h2 class="product-name">@Model.Name</h2>
                    <div>
                        <h3 class="product-price">$@Model.NewPrice <del class="product-old-price">$@Model.Price</del></h3>
                    </div>
                    <p class="product-description">@Model.Description</p>

                    @if (!User.IsInRole("Admin"))
                    {
                        <div class="add-to-cart">
                            <div class="qty-label">
                                Quantity
                                <div class="input-number">
                                    <input type="number">
                                    <span class="qty-up">+</span>
                                    <span class="qty-down">-</span>
                                </div>
                            </div>
                            <a href="javascript:" data-id="@Model.Id" class="add-to-cart-btn"><i class="fa fa-shopping-cart"></i> add to cart</a>
                        </div>
                    }
                </div>
            </div>
            <!-- /Product details -->
            <!-- Product tab -->
            <div class="col-md-12">
                <div id="product-tab">
                    <!-- product tab nav -->
                    <ul class="tab-nav">
                        <li class="active"><a data-toggle="tab" href="#tab1">Description</a></li>
                        <li><a data-toggle="tab" href="#tab2">Specification</a></li>
                    </ul>
                    <!-- /product tab nav -->
                    <!-- product tab content -->
                    <div class="tab-content">
                        <!-- tab1  -->
                        <div id="tab1" class="tab-pane fade in active">
                            <div class="row">
                                <div class="col-md-12">
                                    <p>@Model.Description</p>
                                </div>
                            </div>
                        </div>
                        <!-- /tab1  -->
                        <!-- tab2  -->
                        <div id="tab2" class="tab-pane fade in">
                            <div class="row">
                                <div class="col-md-12">
                                    <p>@Model.Description</p>
                                </div>
                            </div>
                        </div>
                        <!-- /tab2  -->
                    </div>
                    <!-- /product tab content  -->
                </div>
            </div>
            <!-- /product tab -->
        </div>
        <!-- /row -->
    </div>
</div>

<link href="~/Content/jquery.fancybox.css" rel="stylesheet" />

@section Scripts {
    <script src="~/Scripts/jquery.fancybox.js"></script>
    <script>
        $(function () {

            /*
            * Fancybox
            */

            $(".fancybox").fancybox();

            ////////////////////////////////////////////////////////

            /*
            * Add to cart
            */

            $("a.addtocart").click(function (e) {
                e.preventDefault();

                $("span.loader").addClass("ib");

                var url = "/cart/AddToCartPartial";

                $.get(url, { id: @Model.Id }, function (data) {
                    $(".ajaxcart").html(data);
                }).done(function () {
                    $("span.loader").removeClass("ib");
                    $("span.ajaxmsg").addClass("ib");
                    setTimeout(function () {
                        $("span.ajaxmsg").fadeOut("fast");
                        $("span.ajaxmsg").removeClass("ib");
                    }, 1000);
                });
            });

            ////////////////////////////////////////////////////////

            /*
            * Hide old price if there is no discount
            */

            if (@Model.Price===@Model.NewPrice) {
                $(".product-old-price").hide();
            }

            ////////////////////////////////////////////////////////

        });
    </script>
}
